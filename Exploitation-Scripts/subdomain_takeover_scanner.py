import requests

def check_vulnerability(domain):
    # Verifică dacă un subdomeniu pointează către un serviciu cloud neconfigurat
    print(f"[*] Scanning domain: {domain}")
    try:
        response = requests.get(f"http://{domain}", timeout=5)
        if "NoSuchBucket" in response.text or "There is no app configured at this address" in response.text:
            print(f"[CRITICAL] Potential Subdomain Takeover detected on: {domain}")
    except Exception:
        pass

if __name__ == "__main__":
    targets = ["dev.example.com", "test.example.com"]
    for target in targets:
        check_vulnerability(target)
